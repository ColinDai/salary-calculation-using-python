# salary-calculation-using-python
根据员工的指纹机打卡记录计算员工的工资，特别包含了我国不同节日的工资算法（法定节假日3倍，休息日2倍，工作日1.5倍）；适应白班和夜班两个班次（白班时间8-17，夜班时间16:30-0）；员工分为三种类型：员工zs（只计算加班时间，不计算工资），员工s（根据设定的基本工资计算加班时间和工资），员工p（工龄* 100与基本工资的和为总的基本工资）。员工工资的计算方式见example.xlsx表格
程序工作流程：
0.将打卡机中的月打卡数据导出（打卡时间保存在“刷卡记录”的worksheet中），重命名为年月形式（例如：20216，20217等），并另存为xlsx文件；
1.录入员工信息，工龄信息（工作时间），基本工资，员工类别等信息；如果涉及到跨年计算，则有必要更新年份的法定节假日信息；
2.录入需要计算的员工姓名（正式员工计算加班时间，其他员工计算工资）；
3.录入需要计算的起止日期（年月日-年月日）；
4.读取每位员工的打卡机数据，保存在程序变量中，完成后存为对应的.npy文件；
5.根据example.xlsx文件，起止日期，员工姓名等信息创建模板；
6.对4中变量保存的打卡时间做进一步处理，包括去除重复时间（间隔在15min之内），把当天0点至5点的打卡时间剪切储存在上一个日期等；
7.更新可能上夜班的人员名单（所有可能上夜班的人员都放在这个名单里，夜班的时间定为16:30-00:00），根据6得到的打卡时间初步自动分析某员工在某日期是否上夜班；
8.打卡时间初步自动分析，得到每个员工每个日期的上下班打卡时间（除非该员工某天上下班都没有打卡）；
9.将初步自动分析的打卡时间进行人工校正（例如某员工某天下班没打卡，自动分析时，默认补齐下班时间为17点，实际上是18点，这时需要手动校正）；
10.根据校正后的打卡时间，初步自动分析加班时间，缺勤信息；
11.根据步骤10的打卡时间，计算加班工时；
12.人工校正加班工时，缺勤信息等（例如某月某日协定放假，当天未打卡不算缺勤，这时候更改缺勤信息）；
13.根据步骤13得到的加班工时，计算加班工资，全勤奖，正式员工加班时间等信息，得到最终表格；
程序使用流程：
0.首次使用时，录入员工的基本信息：姓名，工作时间（年月日，计算工龄用），员工类型，基本工资等；
1.有增减员工时，更新名字列表，更改example.xlsx；
2.更新需要计算的员工名字；
3.更新需要计算的起止日期；
4.更新可能上夜班的人员名单；
5.打开后缀为“人工分析”的工作表，校正打卡时间，完成后将“人工校正”改为”人工校正后“另存，并输入Yes；
6.打开后缀为“人工校正后+”的工作表，校正加班时间和缺勤天数信息，完成后将“人工校正”改为”人工校正后+1“另存，并输入Yes2；
7.得到后缀为“Final”的表格为最终表格。
